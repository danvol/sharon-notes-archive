---
date: 2021-11-03
updated: 2021-12-14
---

# 第八章 、文件与文件系统的压缩,打包与备份

## 8.1 压缩文件的用途与技术

- [RFC1952 - GZIP file format specification](https://www.ietf.org/rfc/rfc1952.txt)。

## 8.2 Linux 系统常见的压缩指令

**常见压缩文件：**

- `*.Z`：compress 程序压缩的文件。
- `*.zip`：zip 程序压缩的文件。
- `*.gz`：gzip 程序压缩的文件。
- `*.bz2`：bzip2 程序压缩的文件。
- `*.xz`：xz 程序压缩的文件。
- `*.tar`：tar 程序打包的数据，并没有压缩过。
- `*.tar.gz`：tar 程序打包的文件，其中并且经过 gzip 的压缩。
- `*.tar.bz2`：tar 程序打包的文件，其中并且经过 bzip2 的压缩。
- `*.tar.xz`：tar 程序打包的文件，其中并且经过 xz 的压缩。

### 8.2.1 gzip, zcat/zmore/zless/zgrep

**`gzip`：**

```shell
gzip 选项 文件名
-c  # 将压缩的数据输出到屏幕上，可透过数据流重导向来处理
-d  # 解压缩，可以使用 gunzip
-t  # 可以用来检验一个压缩文件的一致性～看看文件有无错误
-v  # 可以显示出原文件/压缩文件案的压缩比等信息
-数字 # 代表压缩等级，-1 最快，但是压缩比最差、-9 最慢，但是压缩比最好！预设是 -6
```

- 可以使用 `zcat`、`zmore`、`zless`、`zgrep` 直接读取 gzip 文件。
- 默认不保留源文件，可以：`gzip -c foo > foo.gz`。

### 8.2.2 bzip2, bzcat/bzmore/bzless/bzgrep

**`bzip2`：**

```shell
bzip2 选项 文件名
-c  # 将压缩的过程产生的数据输出到屏幕上
-d  # 解压缩
-k  # 保留源文件，而不会删除原始的文件
-z  # 压缩（默认值，可以不加）
-v  # 显示出原文件/压缩文件案的压缩比等信息
-数字 # 与 gzip 同样的，都是在计算压缩比的参数，-9 最佳，-1 最快
```

- 可以使用 `bzcat`、`bzmore`、`bzless`、`bzgrep` 直接读取 bzip2 文件。

### 8.2.3 xz, xzcat/xzmore/xzless/xzgrep

**`xz`：**

```shell
xz 选项 文件名
-d  # 解压缩
-t  # 测试压缩文件的完整性，看有没有错误
-l  # 列出压缩文件的相关信息
-k  # 保留原本的文件不删除
-c  # 将数据由屏幕上输出
-数字  # 同样的，也有较佳的压缩比的意思！
```

## 8.3 打包指令： tar

### 8.3.1 tar

**`tar` - 打包压缩：**

```shell
tar 选项 文件名 -C 目录
-c  # 建立打包文件，可搭配 -v 来察看过程中被打包的文件名
-t  # 察看打包文件的内容含有哪些文件
-x  # 解打包或解压缩的功能，可以搭配 -C (大写) 在特定目录解开
    # 特别留意的是：-c, -t, -x 不可同时出现在一串指令列中
-z  # 透过 gzip 的支持进行压缩/解压缩：此时档名最好为 *.tar.gz
-j  # 透过 bzip2 的支持进行压缩/解压缩：此时档名最好为 *.tar.bz2
-J  # 透过 xz 的支持进行压缩/解压缩：此时档名最好为 *.tar.xz
    # 特别留意  vc-z, -j, -J 不可以同时出现在一串指令列中
-v  # 在压缩/解压缩的过程中，将正在处理的文件名显示出来
-f filename # -f 后面要立刻接要被处理的档名！建议 -f 单独写一个选项啰！(比较不会忘记)
-C  # 目录 ：这个选项用在解压缩，若要在特定目录解压缩，可以使用这个选项。
-p(小写) # 保留备份数据的原本权限与属性，常用于备份(-c)重要的配置文件
-P(大写) # 保留绝对路径，亦即允许备份数据中含有根目录存在之意；
--exclude=FILE # 在压缩的过程中，不要将 FILE 打包！
```

## 8.4 XFS 文件系统的备份与还原

### 8.4.1 XFS 文件系统备份 xfsdump

### 8.4.2 XFS 文件系统还原 xfsrestore

## 8.5 光盘写入工具

### 8.5.1 mkisofs：建立映像档

### 8.5.2 cdrecord：光盘刻录工具

## 8.6 其他常见的压缩与备份工具

### 8.6.1 dd

### 8.6.2 cpio

## 8.7 重点回顾

## 8.8 本章习题

## 8.9 参考数据与延伸阅读
