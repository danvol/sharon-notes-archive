---
title: 第6章 复制
hidden: true
date: 2021-09-21
updated: 2021-09-21
---

# 第6章 复制

## 6.1 配置

### 6.1.1 建立复制

| 💡 **怎样建立和断开复制** |
| ------------------------ |

配置复制的方式有以下三种：

-   在配置文件中加入 `slaveof <masterip> <masterport>`
-   在 redis-server 启动命令后加入 `--slaveof <masterip> <masterport>`
-   直接使用命令 `SLAVEOF host port`

使用 `info replication` 查看状态

### 6.1.2 断开复制

-   断开复制：`slaveof no one`
-   可以重新指定切换主节点

### 6.1.3 安全性

-   主节点配置密码：`requirepass`
-   从节点设置密码：`masterauth`

### 6.1.4 只读

-   默认从节点只读：`slave-read-only yes`

### 6.1.5 传输延迟

-   是否禁用 TCP_NODELAY：`repl-disable-tcp-nodelay no`

## 6.2 拓扑

-   一主一从结构
-   一主多从结构
-   树状主从结构

## 6.3 原理

| 🔑 **主从复制原理** ⏱ |
| -------------------- |

### 6.3.1 复制过程

### 6.3.2 数据同步

### 6.3.3 全量复制

### 6.3.4 部分复制

### 6.3.5 心跳

### 6.3.6 异步复制

## 6.4 开发与运维中的问题

### 6.4.1 读写分离

### 6.4.2 主从配置不一致

### 6.4.3 规避全量复制

### 6.4.4 规避复制风暴

## 6.5 本章重点回顾
